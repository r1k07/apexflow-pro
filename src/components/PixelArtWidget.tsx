import { useState, useEffect } from "react";

const PixelArtWidget = () => {
  const [animationFrame, setAnimationFrame] = useState(0);
  const [currentTime, setCurrentTime] = useState(new Date());

  useEffect(() => {
    const animInterval = setInterval(() => {
      setAnimationFrame(prev => (prev + 1) % 4);
    }, 800);
    return () => clearInterval(animInterval);
  }, []);

  useEffect(() => {
    const timeInterval = setInterval(() => {
      setCurrentTime(new Date());
    }, 1000);
    return () => clearInterval(timeInterval);
  }, []);

  // 16:3 aspect ratio pixel art (64x12 pixels)
  const pixelArt = [
    // Frame 1
    [
      "████████████████████████████████████████████████████████████████",
      "█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█",
      "█▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓█",
      "█▓░████░░█████░░███░░██░░░░█████░░██░░░░░█████░░██░░██░░██░░░▓█",
      "█▓░░██░░░░░██░░░███░░██░░░░██░░░░░██░░░░░██░░░░░██░░██░░██░░░▓█",
      "█▓░░██░░░░░██░░░░██░░██░░░░█████░░██░░░░░█████░░░████░░░████░▓█",
      "█▓░░██░░░░░██░░░░██░░██░░░░██░░░░░██░░░░░██░░░░░██░██░░██░██░▓█",
      "█▓░████░░░░██░░░░██░░████░░█████░░████░░░█████░░██░░██░██░░██▓█",
      "█▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓█",
      "█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█",
      "████████████████████████████████████████████████████████████████"
    ],
    // Frame 2
    [
      "████████████████████████████████████████████████████████████████",
      "█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█",
      "█▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓█",
      "█▓░████░░█████░░████░██░░░░█████░░██░░░░░█████░░██░░██░░██░░░▓█",
      "█▓░░██░░░░░██░░░████░██░░░░██░░░░░██░░░░░██░░░░░██░░██░░██░░░▓█",
      "█▓░░██░░░░░██░░░░███░██░░░░█████░░██░░░░░█████░░░████░░░████░▓█",
      "█▓░░██░░░░░██░░░░███░██░░░░██░░░░░██░░░░░██░░░░░██░██░░██░██░▓█",
      "█▓░████░░░░██░░░████░████░░█████░░████░░░█████░░██░░██░██░░██▓█",
      "█▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓█",
      "█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█",
      "████████████████████████████████████████████████████████████████"
    ],
    // Frame 3
    [
      "████████████████████████████████████████████████████████████████",
      "█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█",
      "█▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓█",
      "█▓░████░░█████░░█████░██░░░█████░░██░░░░░█████░░██░░██░░██░░░▓█",
      "█▓░░██░░░░░██░░░█████░██░░░██░░░░░██░░░░░██░░░░░██░░██░░██░░░▓█",
      "█▓░░██░░░░░██░░░░████░██░░░█████░░██░░░░░█████░░░████░░░████░▓█",
      "█▓░░██░░░░░██░░░░████░██░░░██░░░░░██░░░░░██░░░░░██░██░░██░██░▓█",
      "█▓░████░░░░██░░░█████░████░█████░░████░░░█████░░██░░██░██░░██▓█",
      "█▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓█",
      "█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█",
      "████████████████████████████████████████████████████████████████"
    ],
    // Frame 4
    [
      "████████████████████████████████████████████████████████████████",
      "█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█",
      "█▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓█",
      "█▓░████░░█████░░██████░██░░█████░░██░░░░░█████░░██░░██░░██░░░▓█",
      "█▓░░██░░░░░██░░░██████░██░░██░░░░░██░░░░░██░░░░░██░░██░░██░░░▓█",
      "█▓░░██░░░░░██░░░░█████░██░░█████░░██░░░░░█████░░░████░░░████░▓█",
      "█▓░░██░░░░░██░░░░█████░██░░██░░░░░██░░░░░██░░░░░██░██░░██░██░▓█",
      "█▓░████░░░░██░░░██████░████░█████░░████░░█████░░██░░██░██░░██▓█",
      "█▓░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░▓█",
      "█▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓█",
      "████████████████████████████████████████████████████████████████"
    ]
  ];

  const renderPixel = (char: string, index: number) => {
    return (
      <div
        key={index}
        className="w-1.5 h-1.5 transition-colors duration-500"
        style={{
          backgroundColor: char === '█' ? 'hsl(var(--foreground))' :
                          char === '▓' ? 'hsl(var(--electric-blue))' :
                          char === '░' ? 'hsl(var(--cyan-bright))' : 'transparent'
        }}
      />
    );
  };

  const formatTime = (date: Date) => {
    return date.toLocaleTimeString('en-US', { 
      hour12: false,
      hour: '2-digit', 
      minute: '2-digit',
      second: '2-digit'
    });
  };

  return (
    <div className="w-full mb-6 gradient-card shadow-card rounded-xl p-6 overflow-hidden relative">
      <div className="flex items-center justify-center">
        <div className="grid grid-cols-64 gap-0">
          {pixelArt[animationFrame].map((row, rowIndex) =>
            row.split('').map((pixel, pixelIndex) => 
              renderPixel(pixel, rowIndex * 64 + pixelIndex)
            )
          )}
        </div>
      </div>
      
      {/* Digital Clock */}
      <div className="absolute bottom-4 right-6">
        <div className="text-xs font-mono text-electric-blue bg-card/50 backdrop-blur-sm px-2 py-1 rounded border border-border/30">
          {formatTime(currentTime)}
        </div>
      </div>
    </div>
  );
};

export default PixelArtWidget;